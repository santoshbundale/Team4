function updateTargetElement(a,b,c,d){var e=0,f=1,g=b.length;0==g&&feba.domManipulator.disableField(a);for(var h,i,j=0;g>j;j++){var k=b[j];k[e].match(Constants.TARGET)?h=k[f]:k[e].match(c)&&(i=k[f])}setTarget(a,i,d,h)}function getTarget(a){var b=feba.domManipulator.getElementById(a)[0];return b||(b=feba.domManipulator.getElementByName(a)[0]),b}function setDefault(a,b){var c,d=b.split("|"),e=d[0];return d.length>1&&(c=d[1]),new Option(getMessage(e),c)}function setTarget(a,b,c,d){var e=a.type;switch(e){case Constants.SIMPLE_SELECT:setTargetToSimpleSelect(a,b,c,d);break;case Constants.MULTIPLE_SELECT:setTargetToMultipleSelect(a,b,c,d);break;case Constants.TEXTFIELD:setTargetToText(a,b);break;case Constants.RADIO:setTargetToRadioButton(a,b);break;default:a.innerHTML=b}}function setTargetToSimpleSelect(a,b,c,d){var e=getSelectedValues(a,d);a.options.length=0,a.disabled=!1;var f=1;"|"==c?f=0:a.options[0]=setDefault(a,c),b&&feba.domManipulator.each(b,function(b,c){a.options[f]=LIB.__GET_OPTIONS_BY_SPLIT__(c),null!=e&&e==a.options[f].value&&(a.options[f].selected=!0),f++})}function setTargetToMultipleSelect(a,b,c,d){var e=getSelectedValues(a,d);a.options.length=0,a.disabled=!1,a.options[0]=setDefault(a,c);var f=1;0!=e.length&&feba.domManipulator.each(e,function(b,c){return c==a.options[0].value?void(a.options[0].selected=!0):void 0}),b&&feba.domManipulator.each(b,function(b,c){a.options[f]=LIB.__GET_OPTIONS_BY_SPLIT__(c),0!=e.length&&feba.domManipulator.each(e,function(b,c){return c==a.options[f].value?void(a.options[f].selected=!0):void 0}),f++})}function setTargetToRadioButton(a,b){var c=feba.domManipulator.getElementByName(a.name);feba.domManipulator.each(c,function(a){c[a].checked=!1,c[a].value==b&&(c[a].checked=!0)})}function setTargetToText(a,b){b=jQuery("<div></div>").html(b).text(),a.value=b}function getSelectedValues(a,b){var c="";if(b){var d=Constants.TARGET+"_"+a.id;b[d]&&(c=b[d])}return c}function checkCanRaiserequest(a){if(this.options=a,feba.domManipulator.hasValue(LIB.__GET_DOM__(this.options.source))){if(LIB.__GET_DOM__(this.options.source).type!=Constants.RADIO||1==LIB.__GET_DOM__(this.options.source).checked)return!0}else removeTarget(this.options.target);return!1}function removeTarget(a){for(var b=a.split(","),c=b.length,d=0;c>d;d++)-1!=b[d].indexOf("=")&&(targetElementArray=b[d].split("="),2==targetElementArray.length&&(target=LIB.__GET_DOM__(targetElementArray[0]),target||(target=feba.domManipulator.getElementEndingWith(targetElementArray[0])[0]),target.type==Constants.TEXTFIELD?target.value="":target.type==Constants.SIMPLE_SELECT?(target.options.length=0,target.options[0]=setDefault(target,"Select|"),target.options[0].selected=!0):target.type==Constants.RADIO?(target=feba.domManipulator.getElementByName(target.name),feba.domManipulator.each(target,function(a){target[a].checked=!1})):target.innerHTML=""))}function createModal(a){if(null==a.content||0==a.content.length)throw new Exception("Invalid content was returned");containerDiv=feba.domManipulator.getElementById(a.modalDataId),containerDiv.children().remove(),containerDiv.append(a.content)}var AJAX_DEFAULT_PARAMETER="ajaxParameter",AJAX_DEFAULT_PARAMETER_REGEXP=new RegExp("(\\{"+AJAX_DEFAULT_PARAMETER+"\\})","g"),AJAX_PARAM_SPECIFICATION=["criteria","parameters","filter"],_GROUPLETS_IN_PAGE_="";feba.js.ajax={name:"feba.js.ajax",description:"",version:"1.0",ajaxObjects:[],startFlag:!0,add:function(a){LIB.__ADD__(this.ajaxObjects,a)},remove:function(a){LIB.__REMOVE__(this.ajaxObjects,a)},startRequest:function(){LIB.__START__.bind(this)(this.ajaxObjects,feba.js.startFlag)},stopRequest:function(){LIB.__STOP__.bind(this)(this.ajaxObjects)},isRunning:function(){LIB.__IS_RUNNING__.bind(this)()},startEventListening:function(a){LIB.__START_EVENT_LISTENING__(a)},stopEventListening:function(){LIB.__STOP_EVENT_LISTENING__(object)},toString:function(){return this.name+LIB.__TO_STRING__(this.ajaxObjects)}},feba.js.add(feba.js.ajax),feba.js.ajax.groupletCounter=0;var AJAX_CALLOUT_OVERLIB_DEFAULT="STICKY,CLOSECLICK,DELAY,250,TIMEOUT,5000,VAUTO,WRAPMAX,240,CSSCLASS,FGCLASS,'olfg',BGCLASS,'olbg',CGCLASS,'olcg',CAPTIONFONTCLASS,'olcap',CLOSEFONTCLASS,'olclo',TEXTFONTCLASS,'oltxt'";feba.domManipulator.createBaseClass("feba.js.ajax.base",{},{init:function(){},name:"feba.js.ajax.base",description:"",version:"1.0",startFlag:!0,ajaxTimeout:24e4,setAjaxHandlerFunctions:function(){this.options.onError&&this.onError?this.options.error=function(a,b,c){this.options.onError(a,b,c),this.onError(a,b,c)}:!this.options.onError&&this.onError?this.options.error=function(a,b,c){this.onError(a,b,c)}:this.options.onError&&!this.onError&&(this.options.error=function(a,b,c){this.options.onError(a,b,c)}),this.options.onSuccess&&this.onSuccess?this.options.success=function(a,b,c){this.options.onSuccess(a,b,c),this.onSuccess(a,b,c)}:!this.options.onSuccess&&this.onSuccess?this.options.success=function(a,b,c){this.onSuccess(a,b,c)}:this.options.onSuccess&&!this.onSuccess&&(this.options.success=function(a,b,c){this.options.onSuccess(a,b,c)}),this.options.onComplete&&this.onComplete?this.options.complete=function(a,b){this.options.onComplete(a,b),this.onComplete(a,b)}:!this.options.onComplete&&this.onComplete?this.options.complete=function(a,b){this.onComplete(a,b)}:this.options.onComplete&&!this.onComplete&&(this.options.complete=function(a,b){this.options.onComplete(a,b)})},startRequest:function(){LOG.logMessages("Starting "),feba.js.ajax.startFlag&&(this.startFlag=!0)},setListeners:function(){var a=this.options,b=a.source;if(null!=b)if(-1!=b.indexOf("[]")){if(!a.startIndex||!a.endIndex)throw new Error("startIndex,endIndex should be passed");for(var c=[],d=a.startIndex;d<a.endIndex;d++){c[d]=new Object,c[d].modalObj=this;var e=b.replace("[]","["+d+"]");c[d].currentIndex=d;var f=feba.domManipulator.getElementById(e);if(f){var g=this;feba.domManipulator.bind(f,a.eventType,{currentIndex:d},function(a){g.executeEvent.apply(c[a.data.currentIndex]),a.preventDefault()})}}}else{var c=new Object;c.modalObj=this;var f=feba.domManipulator.getElementById(a.source);if(f.length){var g=this;feba.domManipulator.bind(f,a.eventType,{},function(a){return g.execute.apply(c.modalObj),!1})}}},handleErrors:function(a,b,c,d){LIB.__HANDLE_ERROR__(this.riaFeatureID,a,b,c,d,!1,this.source)},stopRequest:function(){LOG.logMessages("Stopping "),this.startFlag=!1},initRequest:function(){if("function"==typeof this.options.onCreate){var a=this.options.onCreate();if(typeof a===Constants.STRING&&Constants.CANCEL===a.toLowerCase())return!1}return!0},getOptions:function(a,b){null==this.options.requestId||this.options.isGrouplet||(this.options.requestId=parseInt(this.options.requestId,10)+1);var c=this.options.requestId;return feba.domManipulator.extendObject({async:this.options.asynchronous||!0,type:this.options.type||"post",evalScripts:this.options.evalScripts||!1,data:this.options.groupletParameters||this.buildParameterString(b),onFailure:this.options.onFailure,onComplete:this.options.onComplete,cache:!1,beforeSend:function(a){a.setRequestHeader("requestId",c)}},a||{})},buildParameterString:function(a){var b,c,d,e,f="",g="eventType",h="onLoad",i=null,j=null,k=null,l=null,m=this.replaceAJAX_DEFAULT(a)||"";if(m=m.split(Constants.PARAMETERS_SEPERATOR),feba.domManipulator.each(m,function(a,b){0!==feba.domManipulator.trim(b).length&&(b=b.split("="),j=feba.domManipulator.trim(b[0]),l=feba.domManipulator.trim(b[1]),k=[],Constants.STRING===typeof l&&feba.domManipulator.trim(l).length>0&&(i=l.match(/\{[\w\.:\(\)\[\]]*\}/g),i=i?LIB.__GET_DOM__(i[0].substring(1,i[0].length-1)):feba.domManipulator.getElementByName(e)[0]),i?Constants.MULTIPLE_SELECT===i.type?(d=feba.domManipulator.serialize(feba.domManipulator.getElement(i)))&&(f+="&"+d):i.type==Constants.TEXTFIELD||"textarea"==i.type||"password"==i.type||"hidden"==i.type||i.type==Constants.SIMPLE_SELECT||"checkbox"===i.type?k.push(i.value):Constants.RADIO===i.type?k.push(feba.domManipulator.getAttribute(feba.domManipulator.getElementByName(i.name),"value")):k.push(i.innerHTML):0!=l.indexOf("{")&&l.indexOf("}")!=l.length-1&&k.push(l),feba.domManipulator.each(k,function(a,b){f+="&"+j+"="+l.replace(l.match(/\{[\w\.:\(\)\[\]]*\}/g),encodeURIComponent(b))}))}),this.options.scope&&(f+="&scope="+encodeURIComponent(this.options.scope)),f=this.setErrorAttributeDetails(f),f=this.setExtraParams(f),"&"===f.charAt(0)&&(f=f.substr(1)),null!=this.options.paramkey&&"parameters"!=this.options.paramkey){for(var n,o=f.split(Constants.AMPERSAND),p={},q=o.length,r=0;q>r;r++)n=o[r].split("="),p[n[0]]=n[1];f=this.options.paramkey+"="+feba.domManipulator.stringify(p)}return b=this.options.executeOnLoad,c=this.options.target,c&&(f+=Constants.AMPERSAND+Constants.TARGET+"="+c),b&&(f+=Constants.AMPERSAND+g+"="+h,this.options.executeOnLoad=!1),f=this.setErrorAttributeDetails(f),f+="&requestId="+this.options.requestId},setErrorAttributeDetails:function(a){var b=this.options.forcontrolIDs;return this.options.errorFormatter&&(a+="&errorFormmater="+encodeURIComponent(formmater)),b&&(a+="&errorForConntrolIds="+encodeURIComponent(b)),a},setExtraParams:function(a){var b=_GROUPLETS_IN_PAGE_;return this.options.isGrouplet&&(a+="&GROUPLETS_IN_PAGE="+encodeURIComponent(b)),a},replaceAJAX_DEFAULT:function(a){for(var b=this.options,c=0;c<AJAX_PARAM_SPECIFICATION.length;c++){var d=AJAX_PARAM_SPECIFICATION[c];if(b[d])return this.options.paramkey=d,b[d]}return null},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.ajaxRequest",{},{init:function(a,b){if(LOG.logMessages("In Ajax request initialize method"),arguments.length<1)return LOG.logMessages("Returning null ,arguments are null"),null;if(this.options=a,a={},!this.initRequest()&&!this.startFlag)return LOG.logMessages("Returning null"),null;var c=this,d=function(a,b,c,d){var e=d.getResponseHeader(Constants.RESPONSE_TYPE);e&&a.options.changeParser&&a.options.parser.type!==e&&(a.options.parser=new LIB.Parser("JSP"===e?"html":void 0)),null!=d.getResponseHeader("action")&&"JSON"==d.getResponseHeader("OPFMT")&&(a.options.parser=new LIB.Parser(Constants.JSON)),a.options.XMLHttpRequest=d,a.options.parser.load(d,a),"MODAL_VIEW.TagHelper"==a.options.tagHelper||"MODAL_VIEW_CONTAINER"==a.options.modalDataId?(a.options.success&&a.options.success.call(a.options.child,b,c,d),a.options.handler(a.options)):(a.options.handler(a.options),a.options.success&&a.options.success.call(a.options.child,b,c,d))},e=function(a,b,c){a.options.complete&&a.options.complete.call(a.options.child,b,c)},f=function(a,b,c,d){a.options.error&&a.options.error.call(a.options.child,b,c,d)},g={success:function(a,b,e){d(c,a,b,e)},complete:function(a,b){e(c,a,b)},error:function(a,b,d){f(c,a,b,d)}};return feba.domManipulator.extendObject(g,this.getOptions(a,b)),"UnitTesting"===CONFIG.operatingMode?(LOG.logMessages("In Testing mode :Dummy Request is raised"),a.onSuccess(),null):(g.timeout=this.ajaxTimeout,g.url=this.options.baseUrl,g.scope=this.options.scope,feba.domManipulator.ajax(g))}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.validatorResponder",{},{init:function(a){this.validateURL(a)},validateURL:function(a){if(null===a.baseUrl||void 0===typeof a.baseUrl||0===feba.domManipulator.trim(a.baseUrl).length)throw new Error("url is wrong/empty")},validateId:function(){}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.autoComplete",{},{init:function(a){this.name="feba.js.ajax.autoComplete",this.version="1.0",this.description="",LOG.logMessages("Initializing the JavaScriptObject "),feba.js.ajax.add(this),this.setOptions(a),this.execute()},setOptions:function(a){a.errorFormatter=encodeURIComponent(a.errorFormatter),a.forcontrolIDs=encodeURIComponent(a.forcontrolIDs),this.options=feba.domManipulator.extendObject({divElement:"ajaxAuto_"+a.source,requestId:0,forcontrolIDs:a.forcontrolIDs,errorFormatter:a.errorFormatter},a||{}),LOG.logMessages("In SetOptions method , options are set")},execute:function(){LOG.logMessages("In Execute method,instantiating AutoCompleter object");var a=feba.domManipulator.getElementById(this.options.source);this.options.sourceName=feba.domManipulator.getAttribute(a,"name");var b=this;a.autocomplete(this.options.baseUrl,{minChars:this.options.minimumCharacters,dataType:Constants.JSON,cacheLength:0,parse:function(a){var c=new LIB.Parser(Constants.JSON_TO_HTML_LIST,!0),d=c.parse(null,a),e=d[0],f=d[1],g=b.options.groupletId,h=b.options.displayExceptions;return b.handleErrors(e,f,g,h,b),"0000"===String(d[4])?(a=d[3],feba.domManipulator.map(a,function(a){return a=a.split("|")[1],{data:a,value:a,result:a}})):void 0},extraParams:{source:this.options.sourceName,Requestid:0,errorFormatter:this.options.errorFormatter,errorForConntrolIds:this.options.forcontrolIDs},formatItem:function(a){return a}})},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.callout",{},{init:function(a){this.name="feba.js.ajax.callout",this.version="1.0",this.description="",LOG.logMessages("Initializing the JavaScriptObject"),feba.js.ajax.add(this),this.setOptions(a),this.setListeners(),this.registerCallout()},setOptions:function(a){this.options=feba.domManipulator.extendObject({parameters:"",overlib:AJAX_CALLOUT_OVERLIB_DEFAULT,parser:new LIB.Parser(Constants.JSON),openEvent:"mouseover",onFocus:"focus",handler:this.handler,child:this,requestId:0},a||{}),this.options.originalParams=this.options.parameters||this.options.criteria,LOG.logMessages("In SetOptions method , options are set"),this.options.handleErrors=this.handleErrors,this.setAjaxHandlerFunctions(),this.options.child=this},setListeners:function(){LOG.logMessages("In SetListeners method, eventListener has been added to element",this.options.source);var a=this.options,b=a.source;if(-1!=b.indexOf("[]")){if(!a.startIndex||!a.endIndex)throw new Error("startIndex,endIndex should be passed");for(var c=[],d=a.startIndex;d<a.endIndex;d++){c[d]=new Object,c[d].modalObj=this;var e=b.replace("[]","["+d+"]");c[d].currentIndex=d;var f=feba.domManipulator.getElementById(e);if(f){var g=this;feba.domManipulator.bind(f,this.options.openEvent,{currentIndex:d},function(a){g.calloutOpen.apply(c[a.data.currentIndex])}),feba.domManipulator.bind(f,this.options.onFocus,{currentIndex:d},function(a){g.calloutOpen.apply(c[a.data.currentIndex])})}}}else{var c=new Object;c.modalObj=this;var f=feba.domManipulator.getElementById(a.source);if(f){var g=this;feba.domManipulator.bind(f,this.options.openEvent,{},function(){g.calloutOpen.apply(c)}),feba.domManipulator.bind(f,this.options.onFocus,{},function(){g.calloutOpen.apply(c)})}}},registerCallout:function(){var a=this.options,b=a.source;if(-1!=b.indexOf("[]")){if(!a.startIndex||!a.endIndex)throw new Error("startIndex,endIndex should be passed");for(var c=[],d=a.startIndex;d<a.endIndex;d++){c[d]=new Object,c[d].modalObj=this;var e=b.replace("[]","["+d+"]");c[d].currentIndex=d;var f=feba.domManipulator.getElementById(e);f&&feba.domManipulator.showCallout({eventElement:f})}}},calloutOpen:function(a){if(this.modalObj.options.originalParams&&-1!=this.modalObj.options.originalParams.indexOf("[]")){var b=this.modalObj.options.originalParams.replace(/\[\]/g,"["+this.currentIndex+"]");this.modalObj.options.parameters?this.modalObj.options.parameters=b:this.modalObj.options.criteria=b}this.modalObj.execute.call(this.modalObj)},execute:function(a){LOG.logMessages("In event handler Execute method,raising the request "),this.request=new feba.js.ajax.ajaxRequest(this.options)},handler:function(){LOG.logMessages("In handler method, Displays the pop-up ");var a=this.parser.content[0][1],b=this.parser.content[1][1],c=this.groupletId,d=this.displayExceptions;if(this.handleErrors(a,b,c,d),"0000"===String(this.parser.content[2][1])){var e=this.parser.content[4][1];if(this.response=this.parser.content[5][1],e==this.requestId){var f=String(this.parameters).split("=")[1];f=f.slice(1,f.length-1),this.response=String(this.response).split("|")[0],this.calloutDescription&&(this.response=this.calloutDescription+":"+this.response),feba.domManipulator.showCallout({eventElement:feba.domManipulator.getElementById(f),response:this.response})}}},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.grouplet",{},{init:function(a){this.setOptions(a),this.isFirstResponse=Constants.TRUE,this.minimize=Constants.TRUE,this.options.target&&(feba.js.ajax.groupletCounter=feba.js.ajax.groupletCounter+1,_GROUPLETS_IN_PAGE_=_GROUPLETS_IN_PAGE_+","+this.options.target),this.setListeners(),this.options.defaultLoad!=Constants.FALSE&&this.execute(),feba.domManipulator.addClass(feba.domManipulator.getElementById(this.options.target),"empty-widget")},setOptions:function(a){this.options=feba.domManipulator.extendObject({close:a.imageClose,evalScripts:!0,eventType:"click",type:"post",handler:this.handler,isGrouplet:!0,defaultLoad:!0,setResponse:this.setResponse,parser:new LIB.Parser("htmltoelementlist"),requestId:a.groupletStackCounter||0,isRequestInProcess:!1,actionElement:"onload",child:this,isIGC:"N"},a||{}),this.setAjaxHandlerFunctions(),this.options.onComplete=this.onComplete,this.options.isFirstRequest=!0,this.options.viewStack=new Map,this.options.child=this,this.options.originalURL=this.options.baseUrl},onComplete:function(){jQuery("#"+this.options.target+" select").sSelect(),feba.domManipulator.css(feba.domManipulator.getElementById(this.options.target),"backgroundImage",""),this.isFirstResponse===Constants.TRUE&&(this.isFirstResponse=Constants.FALSE,menuActionBind(this.options.target))},setListeners:function(){var a=this.options.target;registerMenuHandler(a)},closeGrouplet:function(){feba.js.ajax.groupletCounter=feba.js.ajax.groupletCounter-1;var a=!0;if(0===feba.js.ajax.groupletCounter&&(a=confirm(getMessage("LastWidget"))),a){var b="";if(this.options.title&&(b=this.options.title),this.options.removeUrl){var c=new feba.js.ajax.rpcRequest({JSObjectName:"FEBA.JS.Ajax.RPCRequest",baseUrl:this.options.removeUrl+"&__TARGET_GROUPLET__="+this.options.target+"&__REMOVE_GROUPLET__=true",criteria:this.options.criteria,displayExceptions:!1,onFailure:function(){widgetConfRemoveFail()}});c.execute()}feba.domManipulator.remove(feba.domManipulator.getElementById(this.options.removeGroupletSrc)),0===feba.js.ajax.groupletCounter&&LIB.__HANDLE_ERROR__(null,'<div role = "//alert" class="redbg"><a id="errorlink1" href="#"><img class="absmiddle" title="'+getMessage("NoWidgetsTitle")+'" alt="'+getMessage("NoWidgetsAlt")+'" src="'+getMessage("NoWidgetsImageSrc")+'"></a><span dir="ltr">[CONTLS0004] [100053] </span>'+getMessage("NoWidgets")+"</div>",null,null,"true",!0)}else feba.js.ajax.groupletCounter=feba.js.ajax.groupletCounter+1},toggleGrouplet:function(){this.titleForMinimize,this.minimize===Constants.TRUE?(this.minimize=Constants.FALSE,this.titleForMinimize=feba.domManipulator.getAttribute(feba.domManipulator.getElementById(this.options.target+"_Toggle"),"title"),feba.domManipulator.getElementById(this.options.target).slideUp("300"),feba.domManipulator.setAttribute(feba.domManipulator.getElementById(this.options.target+"_Toggle_img"),"src",imagePath+"/widget-maximize.gif"),feba.domManipulator.setAttribute(feba.domManipulator.getElementById(this.options.target+"_Toggle_img"),"title",getMessage("TitleForMaximize")),feba.domManipulator.setAttribute(feba.domManipulator.getElementById(this.options.target+"_Toggle"),"title",getMessage("TitleForMaximize")),feba.domManipulator.setAttribute(feba.domManipulator.getElementById(this.options.target+"_Toggle_img"),"alt",getMessage("TitleForMaximize"))):(this.minimize=Constants.TRUE,feba.domManipulator.getElementById(this.options.target).slideDown("300"),feba.domManipulator.setAttribute(feba.domManipulator.getElementById(this.options.target+"_Toggle_img"),"src",imagePath+"/Toggle.gif"),feba.domManipulator.setAttribute(feba.domManipulator.getElementById(this.options.target+"_Toggle_img"),"title",this.titleForMinimize),feba.domManipulator.setAttribute(feba.domManipulator.getElementById(this.options.target+"_Toggle_img"),"alt",this.titleForMinimize),feba.domManipulator.setAttribute(feba.domManipulator.getElementById(this.options.target+"_Toggle"),"title",this.titleForMinimize))},execute:function(){feba.domManipulator.setCssProperties(feba.domManipulator.getElementById(this.options.target),{backgroundImage:"url("+this.options.loadingImage+")",backgroundRepeat:"no-repeat",backgroundPosition:"center"}),this.options.isRequestInProcess||(this.options.isRequestInProcess=!0,this.request=new feba.js.ajax.ajaxRequest(this.options))},handler:function(){if(null!=this.parser&&null!=this.parser.content){this.content=this.parser.content[0],contentLength=this.content.length;for(var a=new Map,b=this.parser.content[1],c=0;c<b.length;c++)if(""!=b[c]){var d=b[c].split("=");a.put(d[0].trim(),d[1])}for(var e=0;e<contentLength;e++){var f=feba.domManipulator.getAttribute(this.content[e],Constants.GROUPLET_ID_ATTR);if(f){var g=feba.domManipulator.getChildren(this.content[e],"."+Constants.CROSS_SELL_GROUPLET);0!=g.length&&(feba.domManipulator.getElementById(Constants.CROSS_SELL_CONTAINER).append(g),menuActionBind(f),feba.features[f]&&(feba.features[f].options.isIGC="Y",feba.features[f].options.requestId=0))}if(feba.features[f]){var d=a.get(f);LOG.logMessages("requestId value in handler method of Grouplet: "+d),d=parseInt(d),feba.features[f].setResponse(feba.features[f].options,this.content[e],d,this.parser.content[2],f)}}this.isRequestInProcess=!1,handleTargetGrouplets(this),feba.domManipulator.disableCutCopyPaste(f)}},setResponse:function(a,b,c,d,e){function f(a,b,c,d,e){if(d&&-1!=d.indexOf(e))b.block({message:Constants.RELOADING_MESSAGE,css:{border:"3px solid"}}),a.requestId=parseInt(a.requestId,10)+1,a.refreshPage.call(feba.features[e]);else{var f=document.getElementById(feba.domManipulator.getAttribute(b,"id"));f.innerHTML=c.innerHTML,b.block({message:Constants.PROCESSING_MESSAGE,css:{border:"1px solid",background:"white url(consumer/images/spinner.gif) 50% center no-repeat",backgroundColor:"#f00",height:"15%"}})}}if(LOG.logMessages(e+" request ID check: "+(c==parseInt(a.requestId,10)+1)),a.originalContent=b.innerHTML,("Y"==a.isIGC||1==a.updateParentAction)&&(a.updateParentAction=!1,a.requestId=c-1),target=feba.domManipulator.getElementById(a.target),target)if(LOG.logMessages("View Stack Size in setResponse: "+a.viewStack.size()),a.viewStack.size()>0){if(f(a,target,b,d,e),a.requestId=parseInt(a.requestId,10)+1,a.viewStack.get(parseInt(a.requestId,10)+1)){var g=a.viewStack.get(parseInt(a.requestId,10)+1);a.viewStack.remove(parseInt(a.requestId,10)+1),setTimeout(function(){a.setResponse(a,g,c+1)},1e4)}}else{if(LOG.logMessages("Exception grouplets Logic:"+(d&&-1!=d.indexOf(e))),d&&-1!=d.indexOf(e))return target.block({message:Constants.RELOADING_MESSAGE,css:{border:"3px solid"}}),a.requestId=parseInt(a.requestId,10)+1,void a.refreshPage.call(feba.features[e]);LOG.logMessages("Else logic where response gets appended"),feba.domManipulator.remove(feba.domManipulator.children(target)),feba.domManipulator.append(target,b),feba.features[d]&&(feba.domManipulator.remove(feba.domManipulator.children(feba.domManipulator.getElementById(feba.features[d].options.target))),feba.domManipulator.getElementById(feba.features[d].options.target).block({message:Constants.RELOADING_MESSAGE,css:{border:"3px solid"}}),feba.features[d].options.requestId=0,feba.features[d].execute()),a.requestId=parseInt(a.requestId,10)+1,feba.features[e].options.isCsus&&(feba.features[e].options.requestId=c)}a.isIGC="N"},onError:function(a,b,c){switch(b){case"timeout":case"error":case"abort":case"parsererror":default:this.handleTimeout(a,b,c)}},removeTargetsChildren:function(){var a=feba.domManipulator.getElementById(this.options.target);feba.domManipulator.remove(feba.domManipulator.children(a))},handleTimeout:function(a,b,c){this.onComplete(),this.options.isRequestInProcess=!1;var d=feba.domManipulator.getElementById(this.options.target);feba.domManipulator.append(d,formWidgetErrorPage(b,"feba.features['"+this.options.target+"'].removeTargetsChildren();feba.features['"+this.options.target+"'].execute();"))}});var temp={counter:0};feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.periodicalUpdater",{},{init:function(a){this.name="feba.js.ajax.periodicalUpdater",this.tempCounter=temp.counter,this.tempName=this.name+temp.counter,temp[this.tempName]=this,temp.counter++,this.version="1.0",this.description="",LOG.logMessages("Initializing the JavaScriptObject "),feba.js.ajax.add(this),this.setOptions(a),this.execute()},setOptions:function(a){this.options=feba.domManipulator.extendObject({parser:new LIB.Parser(Constants.JSON),handler:this.handler,requestId:0,child:this},a||{}),this.decay=this.options.decay||2,this.frequency=this.options.frequency||15,this.options.handleErrors=this.handleErrors,this.options.handleErrors=this.handleErrors,this.setAjaxHandlerFunctions(),this.options.child=this,LOG.logMessages("In SetOptions method , options are set")},handler:function(){LOG.logMessages("In handler method rpcRequest, response is set to target "),this.content=this.parser.content;var a=this.target,b=this.content[0][1],c=this.content[1][1],d=this.groupletId,e=this.displayExceptions;if(this.handleErrors(b,c,d,e),"0000"===String(this.parser.content[2][1])){var f=this.content[4][1],g="",h="",i=this.content.length;if(0==a.length||-1==a.indexOf(",")&&-1==a.indexOf("=")){if(a=LIB.__GET_DOM__(this.target),!a)throw new Error("No Target");f==this.requestId&&(a.type==Constants.TEXTFIELD?a.value=this.content[5][1]:a.innerHTML=this.content[5][1])}else{g=a.split(",");for(var j=g.length,k=0;j>k;k++){if(-1==g[k].indexOf("="))throw new Error("Target pattern not proper");if(h=g[k].split("="),2!=h.length)throw new Error("Target pattern not proper");if(a=LIB.__GET_DOM__(h[0]),!a)throw new Error("No Target");if(f==this.requestId)for(var l=5;i>l;l++)h[1]==this.content[l][0]&&(a.type==Constants.TEXTFIELD?a.value=this.content[l][1]:a.innerHTML=this.content[l][1])}}}},execute:function(){LOG.logMessages("In event handler Execute method,raising the request "),this.request=new feba.js.ajax.ajaxRequest(this.options);var a=1e3*this.frequency;setTimeout('temp["'+this.tempName+'"].execute.apply(temp["'+this.tempName+'"])',a)},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.rpcRequest",{},{init:function(a){this.name="feba.js.ajax.rpcRequest",this.version="1.0",this.description="",LOG.logMessages("Initializing the JavaScriptObject "),feba.js.ajax.add(this),this.setOptions(a),this.setListeners(),this.options.executeOnLoad&&this.execute()},setOptions:function(a){this.options=feba.domManipulator.extendObject({parser:new LIB.Parser(Constants.JSON),handler:this.handler,requestId:0,child:this},a||{}),LOG.logMessages("In SetOptions method , options are set"),this.options.originalParams=this.options.criteria||this.options.parameters,this.options.handleErrors=this.handleErrors,this.setAjaxHandlerFunctions(),this.options.child=this},executeEvent:function(){if(this.modalObj.options.originalParams&&-1!=this.modalObj.options.originalParams.indexOf("[]")){var a=this.modalObj.options.originalParams.replace(/\[\]/g,"["+this.currentIndex+"]");this.modalObj.options.parameters?this.modalObj.options.parameters=a:this.modalObj.options.criteria=a,this.modalObj.execute.call(this.modalObj)}},execute:function(){LOG.logMessages("In event handler Execute method,raising the request "),this.request=new feba.js.ajax.ajaxRequest(this.options)},handler:function(){LOG.logMessages("In handler method rpcRequest, response is set to target ");var a=this.parser.exceptionType;if("BE"===a||"BC"===a)return void this.extendedhandler();var b=feba.domManipulator.getElementOfClass("modalCloseImg");b&&(delete feba.features.MODAL_VIEW_CONTAINER,feba.domManipulator.trigger(b,"click")),this.content=this.parser.content;var c=this.target,d=this.content[0][1],e=this.content[1][1],f=this.groupletId,g=this.displayExceptions;if("BI"===a?LIB.__HANDLE_ERROR__(this.riaFeatureID,d,e,f,g,!0,this.source):this.handleErrors(d,e,f,g),"0000"===String(this.parser.content[2][1])){var h=this.content[4][1],i="",j="",k=this.content.length;if(null==c||0==c.length||-1==c.indexOf(",")&&-1==c.indexOf("="))c=LIB.__GET_DOM__(this.target),null!=c&&h==this.requestId&&(c.type==Constants.TEXTFIELD?c.value=this.content[5][1]:c.innerHTML=this.content[5][1]);else{i=c.split(",");for(var l=i.length,m=0;l>m;m++){if(-1==i[m].indexOf("="))throw new Error("Target pattern not proper");if(j=i[m].split("="),2!=j.length)throw new Error("Target pattern not proper");if(c=LIB.__GET_DOM__(j[0]),!c)throw new Error("No Target");if(h==this.requestId)for(var n=5;n<k;n++)if(j[1]==this.content[n][0])if(c.type==Constants.TEXTFIELD)c.value=this.content[n][1];else{var o=c+"";if("[object HTMLDivElement]"==o&&("CustomSearchBoxFG.ACCT"==j[0]||"DashboardFG.ACCT"==j[0]||"CustomSearchBoxFG.LINKED_ACCT"==j[0]||"DashboardFG.LINKED_ACCT"==j[0]||"DashboardFG.CREDITCARDS"==j[0]||"CustomSearchBoxFG.CREDITCARDS"==j[0])||"DashboardFG.SCHEDULEDLIST"==j[0]||"DashboardFG.ICICICREDITCARDS"==j[0]||"CustomSearchBoxFG.SCHEDULEDLIST"==j[0]||"CustomSearchBoxFG.ICICICREDITCARDS"==j[0]||"DashboardFG.BILLERS"==j[0]||"CustomSearchBoxFG.BILLERS"==j[0]||"DashboardFG.POCKETS"==j[0]||"CustomSearchBoxFG.POCKETS"==j[0]|| "DashboardFG.FAVOURITES" == j[0]|| "CustomSearchBoxFG.FAVOURITES" == j[0]|| "DashboardFG.ACCT_INQUIRY" == j[0]|| "CustomSearchBoxFG.ACCT_INQUIRY" == j[0]){var p=this.content[5][1]+"",q="";q=p.split(",");for(var r="",s="",t="",f=0;f<q.length;f++){s=j[0].replace(".","_"),t=q[f].split("|");var u=t[0],v="";u.length>44?(v=u=u.substring(0,44),v+="..."):v=u,r=r+'<div class="submenu-list" onclick="'+s+'_click(this.id)" id="'+v+'" name="account_list"><a>'+v+"</a></div>"}document.getElementById(j[0]).innerHTML=r,c.innerHTML=r}else c.innerHTML=this.content[n][1]}}}}},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.select",{},{init:function(a){this.name="feba.js.ajax.select",LOG.logMessages("Initializing the JavaScriptObject "),feba.js.ajax.add(this),this.version="1.0",this.description="",this.setOptions(a),this.setListeners();var b=!1;switch(LIB.__GET_DOM__(this.options.source).type){case Constants.SIMPLE_SELECT:case Constants.HIDDEN:case Constants.TEXTFIELD:feba.domManipulator.hasValueForId(this.options.source)&&(b=!0);break;case Constants.CHECKBOX:case Constants.RADIO:"true"==LIB.__GET_DOM__(this.options.source).checked&&(b=!0)}"false"!=this.options.executeOnLoad&&b&&this.execute()},setOptions:function(a){this.options=feba.domManipulator.extendObject({parameters:"",emptyOptionValue:"",emptyOptionName:"",defaultOptions:"",eventType:"change",parser:new LIB.Parser(Constants.JSON),handler:this.handler,requestId:0,child:this,selectValue:"select|"},a||{}),this.options.handleErrors=this.handleErrors,LOG.logMessages("In SetOptions method , options are set"),this.setAjaxHandlerFunctions(),this.options.child=this},setListeners:function(){var a=this.options,b=feba.domManipulator.getElementById(a.source);if(b){var c=this;feba.domManipulator.bind(b,a.eventType,{},function(){c.execute.apply(c)}),LOG.logMessages("In SetListeners method, eventListener has been added to element",a.source,"with event Type",a.eventType)}},removeListeners:function(){var a=this.options,b=LIB.__GET_DOM__(a.source);b&&(b["on"+a.eventType]="")},execute:function(){LOG.logMessages("In event handler Execute method,raising the request "),checkCanRaiserequest(this.options)&&(this.request=new feba.js.ajax.ajaxRequest(this.options))},handler:function(){LOG.logMessages("In handler method, response is set to target"),this.content=this.parser.content;var a=this.target;try{var b=this.content[0][1],c=this.content[1][1],d=this.groupletId,e=this.displayExceptions;
if(this.handleErrors(b,c,d,e),"0000"!==String(this.parser.content[2][1]))return void removeTarget(a);var f=this.content[4][1];if(f!=this.requestId)throw new Error("Outdated request");if(0==a.length)throw new Error("Target pattern not proper");for(var g=a.split(","),h=g.length,i=0;h>i;i++){if(-1==g[i].indexOf("="))throw new Error("Target pattern not proper");var j=g[i].split("=");if(2!=j.length)throw new Error("Target pattern not proper");if(a=LIB.__GET_DOM__(j[0]),!a)throw this.stop(),this.removeListeners(),new Error("target lost");updateTargetElement(a,this.content,j[1],this.selectValue);var k=j[0];k.substring(k.indexOf(".")+1);try{jQuery(document.getElementById(k)).resetSS(),jQuery(document.getElementById(k)).focus()}catch(a){LOG.logMessages("Error on invocation of stylish select plugin : "+a)}}}catch(b){a.options.length=0,a.disabled=!1}},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.updateField",{},{init:function(a){this.name="feba.js.ajax.updateField",this.version="1.0",this.description="",LOG.logMessages("Initializing the JavaScriptObject "),feba.js.ajax.add(this),this.setOptions(a),this.setListeners(),feba.js.ajax.add(this)},setOptions:function(a){this.options=feba.domManipulator.extendObject({parameters:"",eventType:"click",parser:null==a.parser?new LIB.Parser(Constants.JSON):a.parser,handler:this.handler,type:"post",selectValue:"select|",child:this,requestId:0},a||{}),this.options.handleErrors=this.handleErrors,this.setAjaxHandlerFunctions(),this.options.child=this,LOG.logMessages("In SetOptions method , options are set")},setListeners:function(){var a=this.options,b=a.action,c=feba.domManipulator.getElementById(a.action),d=this;if(0!==c.length){var e=this.options.source;LIB.__GET_DOM__(e)||(e=this.options.action),!feba.domManipulator.hasValue(c)||LIB.__GET_DOM__(e).type==Constants.RADIO&&1!=LIB.__GET_DOM__(e).checked?(this.options.source=b,checkCanRaiserequest(this.options),feba.domManipulator.bind(c,a.eventType,{},function(){d.execute.apply(d)})):(feba.domManipulator.bind(c,a.eventType,{},function(){d.execute.apply(d)}),this.options.executeOnLoad=!0,d.execute.apply(d))}else d.execute.apply(d);LOG.logMessages("In SetListeners method, eventListener has been added to element")},execute:function(){LOG.logMessages("In event handler Execute method,raising the request ");var a=this.options.source;LIB.__GET_DOM__(a)||(this.options.source=this.options.action),checkCanRaiserequest(this.options)&&(this.options.source=a,this.request=new feba.js.ajax.ajaxRequest(this.options))},handler:function(){LOG.logMessages("In handler method, response is set to target"),this.content=this.parser.content;var a=this.target,b=this.content[0][1],c=this.content[1][1],d=this.groupletId,e=this.displayExceptions;if(this.handleErrors(b,c,d,e),"0000"!==String(this.parser.content[2][1]))return void removeTarget(a);var f=this.content[4][1];if(f!=this.requestId)throw new Error("Outdated request");var g="",h="";if(this.content.length,0==a.length||-1==a.indexOf(",")&&-1==a.indexOf("=")){var i=feba.domManipulator.getElementById(this.target);if(0===i.length)throw new Error("No Target");a=feba.domManipulator.getElementById(this.target)+"> div",LIB.__ADD_POLITE_LIVE_REGION__(a),0===a.length&&(i.append("<div></div>"),a=feba.domManipulator.getIdWithAppend(this.target,"> div"),a=jQuery('[id="'+this.target+'"] > div')),(void 0===requestId||requestId==this.requestId)&&(feba.domManipulator.getAttribute(a,"type")==Constants.TEXTFIELD?feba.domManipulator.setAttribute(a,"value",this.content[5][1]):"string"==typeof this.content?feba.domManipulator.replaceWith(a,this.content):feba.domManipulator.replaceWith(a,this.content[5][1]))}else{g=a.split(",");for(var j=g.length,k=0;j>k;k++){if(-1==g[k].indexOf("="))throw new Error("Target pattern not proper");if(h=g[k].split("="),2!=h.length)throw new Error("Target pattern not proper");if(a=LIB.__GET_DOM__(h[0]),LIB.__ADD_POLITE_LIVE_REGION__(a),!a)throw new Error("No Target");updateTargetElement(a,this.content,h[1],this.selectValue)}}},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.groupletController",{},{init:function(a,b,c){this.execute(a,b,c)},execute:function(a,b,c){for(var d=b.length,e=0;d>e;e++){var f=b[e],g=f.criteria;if(-1!=g.indexOf("{")&&-1!=g.indexOf("}")){var h=g.substring(g.indexOf("{")+1,g.indexOf("}")),i=feba.domManipulator.getGroupletSpecificElementValue(h,a.target);g=g.substring(0,g.indexOf("=")+1)+i}var j=f.groupletId;if(feba.features[j].options.parameters=g,"true"===f.isCrossSell){this.options={},this.options.parameters=g,this.options.parameters=this.buildParameterString();var k=AnalyticsEngine.getResponse(this.options.parameters);if(!k)return;feba.features[j].options.parameters=k}feba.features[j].options.parameters="MenuOptionFG.DYNAMIC_ATTRIBUTES=";var l="";g&&(l+=g),c&&(l.length>0&&(l+=Constants.DYNAMIC_ATTR_SEPERATOR),l+=c),l=l.split(Constants.ASSIGNMENT).join(Constants.PIPE),feba.features[j].options.parameters+=l+Constants.PARAMETERS_SEPERATOR+Constants.IS_CSW_REQUEST+"=Y",feba.features[j].options.groupletParameters=null,feba.features[j].options.baseUrl=feba.features[j].options.originalURL,"null"!=f.baseURL&&""!=f.baseURL&&(feba.features[j].options.baseUrl=f.baseURL),feba.features[j].options.isIGC="Y",this.block(j),feba.features[j].execute.call(feba.features[j])}},block:function(a){var b=feba.domManipulator.getElementById(feba.features[a].options.target);b.block({message:Constants.PROCESSING_MESSAGE,css:{border:"1px solid",background:"white url(consumer/images/spinner.gif) 50% center no-repeat",backgroundColor:"#f00",height:"15%"}})},toString:function(){return this.name+LIB.__TO_STRING__(this)}}),feba.js.ajax.base.extend("feba.js.ajax.modalView",{},{init:function(a){this.name="feba.js.ajax.modalView",this.version="1.0",this.description="",LOG.logMessages("Initializing the JavaScriptObject "),feba.js.ajax.add(this),this.setOptions(a),this.setListeners(),this.extendedOptions={},this.passedOptions=a,this.setAjaxHandlerFunctions(),this.options.executeOnLoad&&this.execute()},setOptions:function(a){this.options=jQuery.extend({parser:new LIB.Parser("html"),handler:this.handler,requestId:0,uiBlocked:!1,type:"post",handleCloseAction:this.handleCloseAction,paintExceptionOnPage:a.paintExceptionOnPage||"true",child:this,listenersReqd:!0},a||{}),this.options.isFirstExecution=!0,LOG.logMessages("In SetOptions method , options are set"),this.options.originalUrl=this.options.baseUrl,this.options.originalParams=this.options.criteria||this.options.parameters,this.options.handleCloseAction=this.handleCloseAction,this.options.handleErrors=this.handleErrors,this.options.modalDataId="MODAL_VIEW_CONTAINER",this.options.child=this,this.originalOptions=a},onError:function(){feba.domManipulator.getElement(".ui-dialog-titlebar-close").show()},executeEvent:function(){if(this.modalObj.options.originalParams&&-1!=this.modalObj.options.originalParams.indexOf("[]")){var a=this.modalObj.options.originalParams.replace(/\[\]/g,"["+this.currentIndex+"]");this.modalObj.options.parameters?this.modalObj.options.parameters=a:this.modalObj.options.criteria=a}else this.modalObj.options.parameters="";if(this.modalObj.options.indexFieldName){var b=parseInt(this.currentIndex)+1,c=this.modalObj.options.indexFieldName+"="+b;this.modalObj.options.parameters?this.modalObj.options.parameters=this.modalObj.options.parameters+","+c:this.modalObj.options.criteria?this.modalObj.options.criteria=this.modalObj.options.criteria+","+c:this.modalObj.options.parameters=c,this.modalObj.options.appendTo&&(this.modalObj.options.appendTo=this.modalObj.options.appendTo.replace(/\[\d*\]/,"["+parseInt(this.currentIndex)+"]"))}this.modalObj.options.groupletParameters=this.modalObj.options.parameters,this.modalObj.options.actionElement="load",this.modalObj.options.baseUrl=this.modalObj.options.originalUrl;var d=feba.features.MODAL_VIEW_CONTAINER=new feba.js.ajax.modalView(this.modalObj.options);d.extendedOptions=this.modalObj.extendedOptions,d.execute()},execute:function(){var a=feba.domManipulator.getElementById(this.options.modalDataId);0==a.length&&"Y"!=this.options.isModalCloseEvent&&(LIB.__CREATE_DIALOG__(this),this.options.modalDialog.dialog("open")),this.showModalWithProcessing(),LOG.logMessages("In event handler Execute method,raising the request "),this.setCloseActions(),this.request=new feba.js.ajax.ajaxRequest(this.options)},showModalWithProcessing:function(){feba.domManipulator.getElement(".ui-dialog-titlebar-close").hide();var a=feba.domManipulator.getElementById(this.options.modalDataId);a.children().remove();var b=feba.domManipulator.getElementById(this.options.processingDivId);0==b.length&&a.append('<div id="'+this.options.processingDivId+'"/>');try{LOG.logMessages("shows the loader images while request is getting processed "),feba.domManipulator.setCssProperties(feba.domManipulator.getElementById(this.options.processingDivId),{backgroundImage:"url("+imagePath+"/widget-loading.gif)",backgroundRepeat:"no-repeat",backgroundPosition:"center",height:this.options.height||"450px",width:this.options.width||"450px"})}catch(a){}},handleCloseAction:function(){this.content=this.parser.content;var a=this.target,b=(this.content[0][1],this.content[1][1],this.groupletId,""),c="",d=this.content.length;if(null==a||0==a.length||-1==a.indexOf(",")&&-1==a.indexOf("="))a=LIB.__GET_DOM__(this.target),null!=a&&(a.type==Constants.TEXTFIELD?a.value=this.content[5][1]:a.innerHTML=this.content[5][1]);else{b=a.split(",");for(var e=b.length,f=0;e>f;f++)if(-1!=b[f].indexOf("=")&&(c=b[f].split("="),2==c.length)){if(a=LIB.__GET_DOM__(c[0]),!a)return;for(var g=5;d>g;g++)c[1]==this.content[g][0]&&(a.type==Constants.TEXTFIELD?a.value=this.content[g][1]:a.innerHTML=this.content[g][1])}}},handler:function(){LOG.logMessages("In handler method modalView, response is set to target "),feba.domManipulator.unblockUI(),this.content=this.parser.content,feba.features.MODAL_VIEW_CONTAINER.options.originalContent=this.content;var a=feba.domManipulator,b=this.parser.exceptionType,c="BE"===b||"BC"===b||"CE"===b||!1,d=a.getElementById(this.modalDataId),e=this.modalDialog?this.modalDialog:d.parent(),f=this.XMLHttpRequest.getResponseHeader("action"),g=this.XMLHttpRequest.getResponseHeader("parentViewId");if("Y"==this.isModalCloseEvent&&"REFRESH"!=f)return e.dialog("destroy"),void delete feba.features.MODAL_VIEW_CONTAINER;if(0!=d.length||null!=f&&void 0!=f)if(null==c||null==f||this.isFirstExecution){if(this.isFirstExecution&&(this.isFirstExecution=!1,c&&("true"==g||"true"==this.paintExceptionOnPage||1==this.paintExceptionOnPage))){e.dialog("close"),feba.domManipulator.getElementById("modalDialog").remove();var h=a.find(a.getElement(this.content),"#MessageDisplay_TABLE"),i=this.__GROUPLET_ID__?this.__GROUPLET_ID__:this.groupletId;return void this.handleErrors(h.wrap("<p/>").parent()[0].innerHTML,null,i,!0)}0==e.dialog("isOpen")&&e.dialog("open"),d.children().remove(),d.append(this.content)}else{if(e.dialog("close"),feba.domManipulator.getElementById("modalDialog").remove(),"UPDATE"==f)this.handleCloseAction();else if("REFRESH"==f)if(this.groupletId&&null!=this.groupletId)feba.features[this.groupletId].options.updateParentAction=!0,feba.features[this.groupletId].setResponse(feba.features[this.groupletId].options,this.content,this.requestId,"",this.groupletId);else{this.contentScripts=this.content.match(new RegExp("<script[^>]*>([\\S\\s]*?)</script>","img")),this.content=this.content.replace(new RegExp("<script[^>]*>([\\S\\s]*?)</script>","img"),""),jQuery("body")[0].innerHTML=this.XMLHttpRequest.responseText;var j=this.contentScripts.length,k=jQuery("div:last");this.groupletId&&(k=a.getElementById(this.groupletId)),window.ajaxPageRefresh="true";for(var l=0;j>l;l++)try{k.append(this.contentScripts[l])}catch(a){}}this.child.setOptions(this.child.passedOptions),this.groupletId&&null!=this.groupletId&&"null"!=this.groupletId&&handleTargetGrouplets(feba.features[this.groupletId].options)}else if(c){var h=a.find(a.getElement(this.content),"#MessageDisplay_TABLE"),i=this.__GROUPLET_ID__?this.__GROUPLET_ID__:this.groupletId;"true"==this.paintExceptionOnPage?this.handleErrors(h.wrap("<p/>").parent()[0].innerHTML,null,i,!0):createModal(this)}else createModal(this);var m=this.parser.title,e=this.modalDialog?this.modalDialog:d.parent();m&&e&&e.dialog("option","title",m),feba.domManipulator.bind(feba.domManipulator.getElement(".ui-dialog-titlebar-close"),"click",{},function(a){var b=feba.features.MODAL_VIEW_CONTAINER.options;b.isModalCloseEvent="Y",b.groupletParameters=b.groupletParameters+"&IS_MODAL_CLOSE_EVENT=Y",null!=b.additionalParamsForClose&&(b.additionalParamsForClose=b.additionalParamsForClose.replace(/\&amp\;/g,"&"),b.groupletParameters=b.groupletParameters+"&"+b.additionalParamsForClose),b.baseUrl=b.CLOSE_URL,feba.features.MODAL_VIEW_CONTAINER.execute(),a.preventDefault(),a.stopImmediatePropagation()}),void 0!=this.abortEvent&&null!=this.abortEvent&&feba.domManipulator.getElement(".ui-dialog-titlebar-close").show(),this.isFirstExecution&&(this.isFirstExecution=!1)},toString:function(){return this.name+LIB.__TO_STRING__(this.options)},setListeners:function(){var a=this.options,b=a.source;if(null!=b)if(-1!=b.indexOf("[]")){if(!a.startIndex||!a.endIndex)throw new Error("startIndex,endIndex should be passed");for(var c=[],d=a.startIndex;d<a.endIndex;d++){c[d]=new Object,c[d].modalObj=this;var e=b.replace("[]","["+d+"]");c[d].currentIndex=d;var f=feba.domManipulator.getElementById(e);if(f){var g=this;feba.domManipulator.bind(f,a.eventType,{currentIndex:d},function(a){return g.executeEvent.apply(c[a.data.currentIndex]),a.stopImmediatePropagation(),a.preventDefault(),!1})}}}else{var c=new Object;c.modalObj=this;var f=feba.domManipulator.getElementById(a.source);if(f.length){var g=this;feba.domManipulator.bind(f,a.eventType,{},function(a){var b=feba.features.MODAL_VIEW_CONTAINER=new feba.js.ajax.modalView(g.options);return b.extendedOptions=g.extendedOptions,a.stopImmediatePropagation(),a.preventDefault(),b.execute(),!1})}}},setCloseActions:function(){options=this.options,options.actionElement==this.extendedOptions.refreshElement&&this.extendedOptions.refreshEvent?options.groupletParameters=options.groupletParameters+"&MODAL_REFRESH_ACTIONS="+this.extendedOptions.refreshEvent:options.actionElement==options.refreshElement&&options.refreshEvent?options.groupletParameters=options.groupletParameters+"&MODAL_REFRESH_ACTIONS="+options.refreshEvent:this.extendedOptions.refresh?options.groupletParameters=options.groupletParameters+"&MODAL_REFRESH_ACTIONS="+this.extendedOptions.refresh:options.refresh&&(options.groupletParameters=options.groupletParameters+"&MODAL_REFRESH_ACTIONS="+options.refresh),options.actionElement==this.extendedOptions.updateElement&&this.extendedOptions.updateEvent?options.groupletParameters=options.groupletParameters+"&MODAL_CLOSE_ACTIONS="+this.extendedOptions.updateEvent:options.actionElement==options.updateElement&&options.updateEvent?options.groupletParameters=options.groupletParameters+"&MODAL_CLOSE_ACTIONS="+options.updateEvent:this.extendedOptions.update?options.groupletParameters=options.groupletParameters+"&MODAL_CLOSE_ACTIONS="+this.extendedOptions.update:options.update&&(options.groupletParameters=options.groupletParameters+"&MODAL_CLOSE_ACTIONS="+options.update)}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.GeoTagging",{},{init:function(a){this.name="feba.js.ajax.GeoTagging",this.version="1.0",this.description="",LOG.logMessages("Initializing the JavaScriptObject "),feba.js.ajax.add(this),this.setOptions(a),this.execute()},setOptions:function(a){this.options=feba.domManipulator.extendObject({latitude:this.latitude,longitude:this.longitude,accuracy:this.accuracy,handler:this.handler,requestId:0},a||{}),this.options.handleErrors=this.handleErrors,LOG.logMessages("In SetOptions method , options are set")},handler:function(){},execute:function(){resultlist=new Array;var a=this.options.parameters,b=new Array;b=a.split("&"),a=b[0].substring(b[0].indexOf("=")+1,b[0].length);var c=b[1].substring(b[1].indexOf("=")+1,b[1].length);"GeoService"==c?resultlist=getGeoLocationService(this.options,a):"GeoHtml"==c?resultlist=getGeoLocationHTML5(this.options,a):"GeoBoth"==c&&(resultlist=getGeoLocationService(this.options,a),resultlist=getGeoLocationHTML5(this.options,a))},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.modalBoxRequest",{},{init:function(a){this.name="feba.js.ajax.modalBoxRequest",this.version="1.0",console.log(a.baseUrl),this.description="",LOG.logMessages("Initializing the JavaScriptObject "),feba.js.ajax.add(this),this.setOptions(a),this.originalOptions=a,this.setListeners(),this.options.executeOnLoad&&this.execute()},setOptions:function(a){this.options=feba.domManipulator.extendObject({parser:new LIB.Parser("html"),handler:this.handler,requestId:0,evalScripts:!0,type:"post",isGrouplet:!0},a||{}),LOG.logMessages("In SetOptions method , options are set"),this.options.originalUrl=this.options.baseUrl,this.options.originalParams=this.options.criteria||this.options.parameters,this.options.handleErrors=this.handleErrors},execute:function(){LOG.logMessages(this,"In event handler Execute method,raising the request "),0===this.options.requestId&&(LIB.__CREATE_DIALOG__(this),this.options.modalDialog.dialog("open"),this.options.modalDialog.hide()),this.request=new feba.js.ajax.ajaxRequest(this.options)},handler:function(){LOG.logMessages("In handler method modalBox, response is set to target "),this.content=feba.domManipulator.getElement(this.parser.content),contentLength=this.content.length,this.contentScripts=this.parser.content.match(new RegExp("<script[^>]*>([\\S\\s]*?)</script>","img"));for(var a=0;a<contentLength;a++){var b=feba.domManipulator.getAttribute(this.content[a],Constants.GROUPLET_ID_ATTR);if(b){var c=feba.domManipulator.getElementById(b.toUpperCase()),d=feba.domManipulator.getChildren(c);d&&feba.domManipulator.remove(d),this.modalDialog.show(),feba.domManipulator.append(this.dialogContent,this.content[a]);var e=this.contentScripts.length;c=feba.domManipulator.getElementById(b.toUpperCase());for(var f=0;e>f;f++)0!=c.length&&feba.domManipulator.append(c,this.contentScripts[f])}}this.requestId=this.requestId+1,feba.domManipulator.getElementOfClass("ui-dialog-titlebar-close").focus()},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}}),feba.js.ajax.base.extend("feba.js.ajax.febaCalendar",{},{init:function(a){this.name="feba.js.ajax.febaCalendar",this.version="1.0",this.description="",LOG.logMessages("Initializing the JavaScriptObject "),feba.js.ajax.add(this),this.setOptions(a),this.options.listenersReqd?this.setListeners():void 0,this.extendedOptions={},this.passedOptions=a,this.options.executeOnLoad&&this.execute()},setOptions:function(a){this.options=jQuery.extend({parser:new LIB.Parser("html"),handler:this.handler,requestId:0,flowCompleted:this.flowCompleted,uiBlocked:!1,type:"post",modalCloseAction:this.modalCloseAction,listenersReqd:!0},a||{}),LOG.logMessages("In SetOptions method , options are set"),this.options.originalUrl=this.options.baseUrl,this.options.originalParams=this.options.criteria||this.options.parameters,this.options.handleErrors=this.handleErrors,this.options.isCalendar=Constants.TRUE,this.options.modalDataId="MODAL_VIEW_CONTAINER",this.options.child=this,this.options.handleCloseActions&&(this.options.revertAction=this.options.handleCloseActions)},executeEvent:function(){if(this.modalObj.options.originalParams&&-1!=this.modalObj.options.originalParams.indexOf("[]")){var a=this.modalObj.options.originalParams.replace(/\[\]/g,"["+this.currentIndex+"]");this.modalObj.options.parameters?this.modalObj.options.parameters=a:this.modalObj.options.criteria=a}else this.modalObj.options.parameters="";if(this.modalObj.options.indexFieldName){var b=parseInt(this.currentIndex)+1,c=this.modalObj.options.indexFieldName+"="+b;this.modalObj.options.parameters?this.modalObj.options.parameters=this.modalObj.options.parameters+","+c:this.modalObj.options.criteria?this.modalObj.options.criteria=this.modalObj.options.criteria+","+c:this.modalObj.options.parameters=c}this.modalObj.options.groupletParameters=null,this.modalObj.options.actionElement="load",this.modalObj.options.baseUrl=this.modalObj.options.originalUrl,this.modalObj.execute.call(this.modalObj)},execute:function(){if(LOG.logMessages("In event handler Execute method,raising the request "),this.options.flowCompleted=!1,this.options.uiBlocked||(feba.domManipulator.blockUI({message:feba.domManipulator.getElementById("loadingImage"),baseZ:950,allowBodyStretch:!1,overlayCSS:{backgroundColor:"#000000",opacity:.4}}),this.options.uiBlocked=!0),null!=this.options.actionElement){if(null!=this.options.closeAction)for(var a=this.options.closeAction.split(","),b=a.length,c=0;b>c;c++){if(null!=this.options.revertAction&&this.options.revertAction==this.options.actionElement&&a[c]==this.options.actionElement)return void this.handleRevertActions();a[c]==this.options.actionElement&&(this.options.flowCompleted=!0)}if(null!=this.options.revertAction&&this.options.revertAction==this.options.actionElement)return this.handleRevertActions(),void(this.extendedOptions.errorCallback&&this.extendedOptions.errorCallback());null!=this.options.conditionalCompleteAction&&this.options.conditionalCompleteAction==this.options.actionElement&&(this.options.flowCompleted=!0)}this.setOptions(jQuery.extend(!0,{},this.options,this.extendedOptions)),this.request=new feba.js.ajax.ajaxRequest(this.options)},handleRevertActions:function(){var a=this,b=feba.domManipulator,c=this.options.modalDataId,d={target:a.options.target,executeOnLoad:!0,type:"post",baseUrl:a.options.baseUrl,groupletParameters:this.options.groupletParameters,changeParser:!0,success:function(){var c=this.options.parser.exceptionType||this.request.options.parser.exceptionType,d="BE"===c||"BC"===c||!1;if(!d){a.flowCompleted=!1;var e=b.getElementOfClass("modalCloseImg");b.trigger(e,"click"),a.options.modalCloseAction()}},extendedhandler:function(){var a=this.parser.exceptionType,b="BE"===a||"BC"===a||!1;if(b){var d=feba.domManipulator,e=d.getElementById(c);e.children().remove(),e.append(this.child.options.parser.content);var f=d.getElementOfClass("modalCloseImg");d.hideElement(f[0])}}};d.groupletParameters=d.groupletParameters.replace("&__RIA__=MODAL_VIEW","&__RIA__=RPC_REQUEST"),d.groupletParameters+="&__ALLOW_CHANGE_OPFMT__=Y&__RIA_ACT_AS_REQUEST__=MODAL_VIEW",d.groupletParameters=d.groupletParameters+(this.options.targetsRequired?"&__TARGETS_REQUIRED__="+this.options.targetsRequired:""),new feba.js.ajax.rpcRequest(d),a.setOptions(a.passedOptions)},handler:function(){LOG.logMessages("In handler method modalView, response is set to target "),feba.domManipulator.unblockUI(),this.content=this.parser.content;var a=feba.domManipulator,b=this.parser.exceptionType,c="BE"===b||"BC"===b||!1,d=a.getElementById(this.modalDataId),e={title:this.title,dataId:this.modalDataId,close:!0,escClose:!1,appendTo:"form",autoPosition:!0,maxHeight:"80%",minHeight:63,maxWidth:"80%"};if(0==d.length)if(c){a.modal(a.find(a.getElement(this.content),"#MessageDisplay_TABLE"),e);var f=this;f.flowCompleted=!1,f.uiBlocked=!1,a.click(a.getElementOfClass("modalCloseImg"),function(){f.modalCloseAction()})}else{this.contentScripts=this.content.match(new RegExp("<script[^>]*>([\\S\\s]*?)</script>","img")),this.content=this.content.replace(new RegExp("<script[^>]*>([\\S\\s]*?)</script>","img"),""),a.modal(this.content,{title:this.title,dataId:this.modalDataId,close:!0,escClose:!1,autoPosition:!0,appendTo:"form",minHeight:this.height||300,minWidth:this.width||500,maxHeight:"80%",maxWidth:"80%"});var g=this.contentScripts.length;d=a.getElementById(this.modalDataId);for(var h=0;g>h;h++)0!=d.length&&d.append(this.contentScripts[h]);var i=a.getElementOfClass("modalCloseImg");a.hideElement(i[0])}else if(this.flowCompleted&&!c){var f=this,i=a.getElementOfClass("modalCloseImg");f.child.options.showSuccessMessage?(a.trigger(i,"click"),setTimeout(function(){a.modal(a.find(a.getElement(f.content),"#MessageDisplay_TABLE"),e),a.click(a.getElementOfClass("modalCloseImg"),function(){f.modalCloseAction()})},500)):(a.click(i,function(){f.modalCloseAction()}),a.trigger(i,"click")),f.child.setOptions(f.child.passedOptions)}else{d.children().remove(),d.append(this.content);var i=a.getElementOfClass("modalCloseImg");a.hideElement(i[0])}},modalCloseAction:function(){this.uiBlocked=!1,this.flowCompleted?this.successCallback&&this.successCallback():this.errorCallback&&this.errorCallback()},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}}),feba.domManipulator.createChildClass(feba.js.ajax.base,"feba.js.ajax.dynamic",{},{init:function(a){switch(this.name="feba.js.ajax.dynamic",LOG.logMessages("Initializing the JavaScriptObject "),feba.js.ajax.add(this),this.version="1.0",this.description="",this.setOptions(a),this.setListeners(),feba.domManipulator.getType(this.options.source)){case"select-one":feba.domManipulator.hasValueForId(this.options.source)&&(this.options.executeOnLoad=!0);break;case"checkbox":feba.domManipulator.isChecked(this.options.source)&&(this.options.executeOnLoad=!0)}this.options.executeOnLoad&&this.execute()},setOptions:function(a){this.options=feba.domManipulator.extendObject({parameters:"",eventType:"change",parser:new LIB.Parser(Constants.JSON),handler:this.handler,child:this,requestId:0},a||{}),this.options.handleErrors=this.handleErrors,this.setAjaxHandlerFunctions(),this.options.child=this,LOG.logMessages("In SetOptions method , options are set")},setListeners:function(){var a=this.options,b=feba.domManipulator.getElementById(a.source);if(b){var c=this;feba.domManipulator.bind(b,a.eventType,{},function(){c.execute.apply(c)}),LOG.logMessages("In SetListeners method, eventListener has been added to element",a.source,"with event Type",a.eventType)}},execute:function(){LOG.logMessages("In event handler Execute method,raising the request "),checkCanRaiserequest(this.options)&&(this.request=new feba.js.ajax.ajaxRequest(this.options))},handler:function(options){function drawTargetElement(target,content,targetElement,targetType){var source=feba.domManipulator.getElementById(options.source);if(!source)throw new Error("Source is not Proper");var parent=feba.domManipulator.parent(feba.domManipulator.parent(source)),contentLen=content.length;if(removeChildNodesOfTarget(parent,target),0!=contentLen&&0!=feba.domManipulator.getAttribute(source,"checked")){for(var targetContent=null,contentSet=null,k=0;contentLen>k;k++)null!=content[k][0]&&content[k][0].match(Constants.TARGET_LITERAL)&&(targetContent=content[k][1]),null!=content[k][0]&&content[k][0].match(targetElement)&&(contentSet=content[k][1]);var tableproperties=new Object({targetName:target,no_of_columns:options.columnCount,inputType:targetType});if(options.style){for(var params=options.style.split(Constants.COMMA),map=new Object,i=0;i<params.length;i++){var parts=params[i].split(Constants.COLON);if(2!=parts.length)throw new Error("style pattern not proper");map[parts[0]]=parts[1]}feba.domManipulator.extendObject(tableproperties,map)}var spanId=Constants.SPAN+target,spanElement=feba.domManipulator.createSpanElement(spanId),labelElement=feba.domManipulator.createLabelElement(map.caption_style,options.caption);if(feba.domManipulator.setAttribute(labelElement,"style","display:block"),feba.domManipulator.appendChild(spanElement,labelElement),content)if("yes"==options.displayInTable){var table=feba.domManipulator.createTable(tableproperties,contentSet,targetContent);feba.domManipulator.appendChild(spanElement,table)}else{var selectedValues=feba.domManipulator.getSelectedValues(target,targetContent),childSpan=feba.domManipulator.createSpanElement();feba.domManipulator.appendChild(spanElement,childSpan),feba.domManipulator.each(contentSet,function(a,b){var c=feba.domManipulator.createParaElement(),d=feba.domManipulator.createDynamicElement(b,target,targetType,selectedValues);feba.domManipulator.addClass(d,tableproperties.element_style),feba.domManipulator.appendChild(c,d),feba.domManipulator.appendChild(childSpan,c)})}for(var ancestor=feba.domManipulator.parent(feba.domManipulator.getElement(parent)),i=0;3>i;i++)feba.domManipulator.appendChild(ancestor,feba.domManipulator.createBreakElement());feba.domManipulator.appendChild(ancestor,spanElement);var tarArray=feba.domManipulator.getElementByName(target);loadFunction=function(){var code="myFunc = "+options.functionName;return eval(code)},feba.domManipulator.bind(tarArray,options.eventType,"",loadFunction())}}function removeChildNodesOfTarget(a,b){var c=Constants.SPAN+b,d=feba.domManipulator.getElementById(c);d&&feba.domManipulator.parent(d)==feba.domManipulator.parent(a)&&feba.domManipulator.remove(d);var e=feba.domManipulator.children(feba.domManipulator.getElement(feba.domManipulator.parent(a)));feba.domManipulator.each(e,function(a,b){"BR"==b.tagName&&feba.domManipulator.remove(feba.domManipulator.getElement(b))})}options.content=options.parser.content;var target=options.target;try{var targetElementArray="",notProperTarget=0==target.length||-1==target.indexOf(Constants.ASSIGNMENT);if(notProperTarget)throw new Error("Target pattern not proper");if(targetElementArray=target.split(Constants.ASSIGNMENT),2!=targetElementArray.length)throw new Error("Target pattern not proper");target=targetElementArray[0],drawTargetElement(target,this.content,targetElementArray[1],this.targetType)}catch(a){removeChildNodesOfTarget(parent,target)}},toString:function(){return this.name+LIB.__TO_STRING__(this.options)}});